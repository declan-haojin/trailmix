default:
  image: node:20.11.1

stages:
  - deploy

deploy_server:
  stage: deploy
  script:
    - cd server
    - export VERCEL_PROJECT_ID=$VERCEL_PROJECT_ID_CLIENT
    - echo "SERVER_PROJECT_ID $VERCEL_PROJECT_ID"
    - npm install --global vercel
    - vercel deploy --prod --token=$VERCEL_TOKEN
  only:
    - master

deploy_client:
  stage: deploy
  script:
    - cd client
    - export VERCEL_PROJECT_ID=$VERCEL_PROJECT_ID_CLIENT
    - echo "CLIENT_PROJECT_ID $VERCEL_PROJECT_ID"
    - npm install --global vercel
    - vercel deploy --prod --token=$VERCEL_TOKEN
  only:
    - master








#default:
#  image: node:20.11.1
#
#stages:
#  - deploy
#
#deploy_server_preview:
#  stage: deploy
#  except:
#    - master
#  script:
#    - cd server
#    - npm install --global vercel
#    - vercel pull --yes --environment=preview --token=$VERCEL_TOKEN --scope your-server-vercel-project
#    - vercel build --token=$VERCEL_TOKEN
#    - vercel deploy --prebuilt --token=$VERCEL_TOKEN
#  variables:
#    VERCEL_PROJECT: your-server-vercel-project

#deploy_client_preview:
#  stage: deploy
#  except:
#    - master
#  script:
#    - cd client
#    - npm install --global vercel
#    - vercel deploy --prebuilt --token=$VERCEL_TOKEN
#  variables:
#    VERCEL_PROJECT: your-client-vercel-project

#deploy_server_production:
#  stage: deploy
#  only:
#    - master
#  script:
#    - cd server
#    - npm install --global vercel
#    - vercel pull --yes --environment=production --token=$VERCEL_TOKEN --scope your-server-vercel-project
#    - vercel build --prod --token=$VERCEL_TOKEN
#    - vercel deploy --prebuilt --prod --token=$VERCEL_TOKEN
#  variables:
#    VERCEL_PROJECT: your-server-vercel-project
#
#deploy_client_production:
#  stage: deploy
#  only:
#    - master
#  script:
#    - cd client
#    - npm install --global vercel
#    - vercel deploy --prebuilt --prod --token=$VERCEL_TOKEN
#  variables:
#    VERCEL_PROJECT: your-client-vercel-project